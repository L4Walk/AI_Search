<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>搜索界面</title>

    <link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <style lang="scss">
        @import url(https://fonts.googleapis.com/css?family=Patrick+Hand+SC);
        /* 添加一些简单的样式 */
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-weight: 500;
            font-family: "Microsoft YaHei","宋体","Segoe UI", "Lucida Grande", Helvetica, Arial,sans-serif, FreeSans, Arimo,'Patrick Hand SC', cursive;
        }
        div.search {padding: 30px 0;}

        form {
            position: relative;
            width: 300px;
            margin: 0 auto; /*设置宽度后，居中*/
        }

        input, button {
            border: none;
            outline: none;
        }

         /*搜索框1*/
        .bar input {
            width: 100%;
            height: 42px;
            padding-left: 13px;
            border: 2px solid #2775b6;
            border-radius: 19px;   /*border-radius 属性用于向元素添加圆角边框：*/
            background: transparent;  /*背景透明*/
        }
        .bar button {
            height: 42px;
            width: 42px;
            cursor: pointer;  /*cursor属性定义了鼠标指针放在一个元素边界范围内时所用的光标形状*/
            position: absolute;
            background: #126bae;
            border-radius: 0 19px 19px 0;
            width: 60px;
            right: 0;
        }
        .bar button:before {
            content: "\f002";
            font-family: FontAwesome;
            font-size: 16px;
            color: #F9F0DA;
        }

        .bar button:hover{
            background-color: #1661ab;  /*点击搜索按钮时的背景颜色*/
        }

        .search-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        /*结果框*/
        .results {
            border: 1px solid #ccc;
            padding: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        /* 卡片样式 */
.card {
    border: 2px solid #144a74;
    padding: 10px;
    margin: 10px 0;
    border-radius: 5px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    background-color: #ffffff;
}

.card-title {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;
    text-align: center;
}

.card :hover{
    background-color: #93b5cf;
}

@keyframes animated-border {
  0% {
    box-shadow: 0 0 0 0 #2b73af;
  }
  100% {
     box-shadow: 0 0 0 20px #101f30;
  }
}

#card {
  animation: animated-border 1.5s infinite;
  font-family: Arial;
  font-size: 18px;
  line-height: 30px;
  font-weight: bold;
  color: #144a74;
  border: 2px solid;
  border-radius: 10px;
  padding: 15px;
}

.card-url {
    color: #007BFF;
    text-decoration: none;
    font-size: 16px;
}

.container .button-wrapper:nth-child(5n+1) div:before {
  border-color: #FF8B94;
}

.container .button-wrapper:nth-child(5n+1) div {
  border-color: #FF8B94;
}

.container .button-wrapper:nth-child(5n+2) div:before {
  border-color: #02A7E1;
}

.container .button-wrapper:nth-child(5n+2) div {
  border-color: #02A7E1;
}

.container .button-wrapper:nth-child(5n+3) div:before {
  border-color: #98CB4A;
}

.container .button-wrapper:nth-child(5n+3) div {
  border-color: #98CB4A;
}

.container .button-wrapper:nth-child(5n+4) div:before {
  border-color: #AE5A41;
}

.container .button-wrapper:nth-child(5n+4) div {
  border-color: #AE5A41;
}

.container .button-wrapper:nth-child(5n+5) div:before {
  border-color: #F7D842;
}

.container .button-wrapper:nth-child(5n+5) div {
  border-color: #F7D842;
}

.container {
  z-index: 99;
  width: 100%;
  height: 5vh;
  display: flex;
  justify-content: left;
  align-items: center;
  flex: auto;
  flex-wrap: wrap;
}
.container .button-wrapper {
  overflow: hidden;
}
.container .button-wrapper .button {
  position: relative;
  text-transform: uppercase;
  color: #fff;
  border: solid 2px #02A7E1;
  padding: 10px 30px;
  z-index: 1;
}
.container .button-wrapper .button::before {
  position: absolute;
  border-bottom: solid 3px;
  content: "";
  min-height: 10px;
  min-width: 100px;
  z-index: 200;
  left: 50%;
  transform: translateX(-50%);
  top: 60%;
  opacity: 1;
  transition-duration: 0.5s;
}
.container .button-wrapper .button::after {
  pointer-events: none;
  position: absolute;
  content: "";
  width: 600px;
  height: 160px;
  border-radius: 50%;
  background-color: #93b5cf;
  top: -120%;
  left: -30%;
  z-index: -10;
  transition-duration: 2s;
}
.container .button-wrapper .button:hover:after {
  width: 0;
  height: 50px;
}
.container .button-wrapper .button:hover:before {
  opacity: 0;
}


    </style>
</head>

<body>
    <!--
    <div >
        <div class="search bar">
            <form>
                <input type="text"  id="searchInput" placeholder="请输入您要搜索的内容...">
                <button type="submit" onclick="search()"></button>
            </form>
        </div>
    </div>
-->

    <div class="search-container bar">
        <input type="text" id="searchInput" placeholder="输入您的问题...">
        <button onclick="search()"></button>
    </div>

    <div class="results" id="resultsContainer">
        <!-- 这里会显示搜索结果 -->
    </div>

    <script>
        // TODO: 添加与后端交互的JavaScript代码
        
        async function search() {
    const query = document.getElementById('searchInput').value;
            console.log(query);
    if (!query) {
        alert('请输入您的问题！');
        return;
    }
    const resultsContainer = document.getElementById('resultsContainer');
    resultsContainer.innerHTML = `<button aria-busy="true">蓝衫导航AI助手正在卖力搜索中…</button>`;

    const response = await fetch('http://aisearch.chuheng.tech/ask', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ query: query })
    });

    const data = await response.json();

    console.log(data);
    var result = data.result;
    var posts = data.post_data;


    resultsContainer.innerHTML = "";// 清空
    // 显示结果

//resultsContainer.innerHTML = `<div class="card"><strong>蓝衫导航AI助手：</strong> ${data.result}</div>`;
resultsContainer.innerHTML=`<article><strong>蓝衫导航AI助手：</strong> ${data.result}</article>`
if (data.post_data && data.post_data.length) {
    data.post_data.forEach(post => {
        const title = post.post_title;
        const url = post.post_url;
        
        /*
        const cardHtml = `
            <a href="${url}" target="_blank" style="text-decoration: none; color: inherit;">
                <div class="card">
                    <div class="card-title">${title}</div>
                </div>
            </a>`;
            
            const cardHtml = `
            <div class="container">
            <a href="${url}" target="_blank" style="text-decoration: none; color: inherit;">
                <div class="button-wrapper">
                    <div class="button">
                        <span class="text">${title}</span>
                    </div>
                 </div>
            </a>
            </div>`;
            */

        /*const cardHtml = `<a href="${url}" role="button" class="outline">${title}</a> `*/

        const cardHtml = `<a href="${url}" <article>${title}</article></a>`
        resultsContainer.innerHTML += cardHtml;

        });
    }
}

    </script>
</body>

</html>
